const axios = require('axios')

cookie = 'UIFID_TEMP=4dcf94af82ac0fef720a2d8219d3b55c620704ce678b8fb5e9b4b9df31cb630a89305be38434f7a388edccb3553a7ca4fefc7a434f7512825f7f67b3ed1a5fb185ab20037925267e55c3811169f9dd56; hevc_supported=true; home_can_add_dy_2_desktop=%220%22; volume_info=%7B%22isUserMute%22%3Afalse%2C%22isMute%22%3Afalse%2C%22volume%22%3A0.5%7D; passport_csrf_token=b056a5ad33db899b738a364b16774105; passport_csrf_token_default=b056a5ad33db899b738a364b16774105; __security_mc_1_s_sdk_crypt_sdk=8aced771-4cea-a97a; bd_ticket_guard_client_web_domain=2; UIFID=4dcf94af82ac0fef720a2d8219d3b55c620704ce678b8fb5e9b4b9df31cb630a89305be38434f7a388edccb3553a7ca4387d4327e2eada81965a88a17df0db60ad95d4a12d8e4fab08190713b79ab4713f1cbd7bd79219fcd0db54a351741e18472bb1d4bbde16eb8b0dd17a5c609ea2112ce223a429e60450cdf34213df2d2f4555d5f8d22f301ccaec28a3a2fe76ef9c296d5ea22bb3dd0de1e4d41595ec19; is_dash_user=1; is_staff_user=false; SelfTabRedDotControl=%5B%5D; __security_mc_1_s_sdk_cert_key=345cd75b-4b68-859d; __security_server_data_status=1; FOLLOW_LIVE_POINT_INFO=%22MS4wLjABAAAAz8lykIJ7932wV6fWcTKJHyQ1AigN1ZhslfyPxfZuKQo%2F1744041600000%2F0%2F0%2F1744013454949%22; strategyABtestKey=%221744105245.035%22; stream_player_status_params=%22%7B%5C%22is_auto_play%5C%22%3A0%2C%5C%22is_full_screen%5C%22%3A0%2C%5C%22is_full_webscreen%5C%22%3A0%2C%5C%22is_mute%5C%22%3A0%2C%5C%22is_speed%5C%22%3A1%2C%5C%22is_visible%5C%22%3A1%7D%22; FORCE_LOGIN=%7B%22videoConsumedRemainSeconds%22%3A180%2C%22isForcePopClose%22%3A1%7D; download_guide=%222%2F20250408%2F0%22; n_mh=Xct6vbRSosX3FaRoQGBQX3aVFZgAaih0wusNwVkOQP4; login_time=1744105322132; FOLLOW_NUMBER_YELLOW_POINT_INFO=%22MS4wLjABAAAA77CtGl5KSzFyij5gNxe-Rlqg8m3Qr3LFIzgWi0vt8rtLE_4e-LKvc7LiFn0qTaXQ%2F1744128000000%2F0%2F0%2F1744109824115%22; IsDouyinActive=true; stream_recommend_feed_params=%22%7B%5C%22cookie_enabled%5C%22%3Atrue%2C%5C%22screen_width%5C%22%3A1920%2C%5C%22screen_height%5C%22%3A1080%2C%5C%22browser_online%5C%22%3Atrue%2C%5C%22cpu_core_num%5C%22%3A12%2C%5C%22device_memory%5C%22%3A8%2C%5C%22downlink%5C%22%3A1.75%2C%5C%22effective_type%5C%22%3A%5C%224g%5C%22%2C%5C%22round_trip_time%5C%22%3A150%7D%22; publish_badge_show_info=%220%2C0%2C0%2C1744108766952%22; passport_mfa_token=Cjc%2BaMCEYMiNVtCR2EtQVXYL1uhhlg1VM%2B7JMRIGVLoYhqASyfoSw6Q40KPIpR2tU8ODuyrs83xIGkoKPAAAAAAAAAAAAABO2hpRXQR8Y4e2JbnUkaZA99vlthJISxmL%2FODu%2FLqYuT%2FvT%2BWNGpTIaewL%2FjIUZsWKHBCUmO4NGPax0WwgAiIBA8Ae7Sc%3D; d_ticket=ce128df7e93aaacdfb2fbb3753a9c77d1ff5d; passport_assist_user=CkFizsiTzHPoVpFRGFQNwSmbaEwAOPlXu-LXm44lSdda8zWGkbBABBh8Rrj0noQ_qnDBb7AknmvV7Nphgd7OOnDRVxpKCjwAAAAAAAAAAAAATtpu-LwwreprnED01j_OdYlm6LJ0s3PY66s0-bctrnkq20et6NrUtUgwfV_Pbqp8E8cQlJjuDRiJr9ZUIAEiAQMq3Q6R; sid_guard=2563160c9d85093c9f945e27a9d0e69f%7C1744108827%7C5184000%7CSat%2C+07-Jun-2025+10%3A40%3A27+GMT; uid_tt=c365f87bcc39f1e38d80354a2817c836; uid_tt_ss=c365f87bcc39f1e38d80354a2817c836; sid_tt=2563160c9d85093c9f945e27a9d0e69f; sessionid=2563160c9d85093c9f945e27a9d0e69f; sessionid_ss=2563160c9d85093c9f945e27a9d0e69f; sid_ucp_v1=1.0.0-KDU3OTc0N2FmYWJkZTg2MWE0Yjk1YzU4MjE5ZWI4YThlM2Y3N2U5ZjgKIQi7yJDZ8s2WAhCb-tO_BhjaFiAMMOHlyq8GOAdA9AdIBBoCbGYiIDI1NjMxNjBjOWQ4NTA5M2M5Zjk0NWUyN2E5ZDBlNjlm; ssid_ucp_v1=1.0.0-KDU3OTc0N2FmYWJkZTg2MWE0Yjk1YzU4MjE5ZWI4YThlM2Y3N2U5ZjgKIQi7yJDZ8s2WAhCb-tO_BhjaFiAMMOHlyq8GOAdA9AdIBBoCbGYiIDI1NjMxNjBjOWQ4NTA5M2M5Zjk0NWUyN2E5ZDBlNjlm; _bd_ticket_crypt_doamin=2; _bd_ticket_crypt_cookie=7c0bb834d41b143dd17f4fbabde17adf; __security_mc_1_s_sdk_sign_data_key_web_protect=b078525b-47fc-97eb; bd_ticket_guard_client_data=eyJiZC10aWNrZXQtZ3VhcmQtdmVyc2lvbiI6MiwiYmQtdGlja2V0LWd1YXJkLWl0ZXJhdGlvbi12ZXJzaW9uIjoxLCJiZC10aWNrZXQtZ3VhcmQtcmVlLXB1YmxpYy1rZXkiOiJCQWIrbkc4VTNCd2k0RDV6N1gyWXBEUjR6VEQ4Y2VhT2JjcVpXMm9BbkZsb3FRL2pBWUtIN0t5QUV3bHUrb201MEVGQ0t0aVdwZVgraTFZaDB6Y2gxSmc9IiwiYmQtdGlja2V0LWd1YXJkLXdlYi12ZXJzaW9uIjoyfQ%3D%3D; odin_tt=5fb9da1298de1b4d06191bacc34fedd042ff0a6d8aea19edf1ebbe4f7d23972da080a38f65a8299cc877a5b08366fdd4793eee9c3398d613f1b27cc5db27dd4c; ttwid=1%7C7kaRB4KDSV51usKXumzT2ASXUdNxNS2h1AQu5OhERW4%7C1744167464%7C9b81e8babd0c69273e3f540e256989c4b6d54e76e40d806ed0b2f024ad20f9f1; '

keyword = '周杰伦'

music({cookie, keyword})

async function music({cookie, keyword}) {
    console.log(`参数---:`,     {cookie, keyword}        )
    // 请求签名signature
    var config = {method: 'get', url: 'https://creator.douyin.com/web/api/media/aweme/search/post/auth', headers: {Cookie: cookie}}
    var {data: resp} = await axios(config)
    let signature = resp.signature
    console.log('signature---:', signature)
    // 请求音乐
    var config = {method: 'get', url: `https://tsearch.amemv.com/openapi/aweme/v1/music/search/?aid=1128&count=20&search_source=normal_search&keyword=${keyword}&cursor=0`, headers: {'Accept-Language': 'zh-CN', 'Agw-Auth': signature}}
    var {data: resp} = await axios(config)
    let list = resp.music
    let music = list.map(o => ({id: o.id_str, name: o.title, author: o.author, album: o.album, duration: o.duration, url: o.play_url.uri, cover: o.cover_hd.url_list[0]}))
    console.log('music---:', music)
    return music
}
